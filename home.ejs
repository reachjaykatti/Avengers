
<%- include('../partials/head', {title}) %>

<h1>Admin</h1>

<div class="grid">
  <div class="card">
    <div style="margin-bottom:.5rem">
      <a class="btn" href="/admin/series/new">+ New Series</a>
      <a class="btn" href="/admin/users/new" style="margin-left:.5rem">+ Add User</a>
    </div>

    <h2>Series</h2>
    <table class="table">
      <tr>
        <th>Name</th>
        <th>Dates (IST)</th>
        <th>Members</th>
        <th>Lock</th>
        <th>Manage</th>
        <th>Edit</th>
        <th>Delete</th>
      </tr>

      <% series.forEach(function(s){ %>
        <tr>
          <td><%= s.name %></td>

          <!-- C1: Show Start/End in IST (computed in the route as startIst/endIst) -->
          <td>
            <%= (s.startIst && s.startIst.length) ? s.startIst : '—' %>
            →
            <%= (s.endIst && s.endIst.length) ? s.endIst : '—' %>
          </td>

          <!-- Keep your existing actions/links untouched -->
          <td>
            <a href="/admin/series/<%= s.id %>/members">Manage</a>
          </td>

          <td>
            <% if (!s.is_locked) { %>
              <form method="post"
                    action="/admin/series/<%= s.id %>/lock"
                    onsubmit="return confirm('Lock this series? No new members after lock.');">
                <button class="btn btn-warn" type="submit">Lock</button>
              </form>
            <% } else { %>
              <span class="badge started">Locked</span>
            <% } %>
          </td>

          <td><a class="btn" href="/admin/series/<%= s.id %>/matches">Manage Matches</a></td>
          <td><a class="btn" href="/admin/series/<%= s.id %>/edit">Edit</a></td>

          <td>
            <form method="post"
                  action="/admin/series/<%= s.id %>/delete"
                  onsubmit="return confirm('Delete entire series (matches, members, and points ledgers)?');">
              <button class="btn btn-warn" type="submit">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </table>
  </div>
</div>

<%- include('../partials/foot') %>
